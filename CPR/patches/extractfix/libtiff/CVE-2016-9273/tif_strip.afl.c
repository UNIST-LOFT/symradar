/* $Id$ */

/*
 * Copyright (c) 1991-1997 Sam Leffler
 * Copyright (c) 1991-1997 Silicon Graphics, Inc.
 *
 * Permission to use, copy, modify, distribute, and sell this software and 
 * its documentation for any purpose is hereby granted without fee, provided
 * that (i) the above copyright notices and this permission notice appear in
 * all copies of the software and related documentation, and (ii) the names of
 * Sam Leffler and Silicon Graphics may not be used in any advertising or
 * publicity relating to the software without the specific, prior written
 * permission of Sam Leffler and Silicon Graphics.
 * 
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND, 
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY 
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  
 * 
 * IN NO EVENT SHALL SAM LEFFLER OR SILICON GRAPHICS BE LIABLE FOR
 * ANY SPECIAL, INCIDENTAL, INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND,
 * OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
 * WHETHER OR NOT ADVISED OF THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF 
 * LIABILITY, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE 
 * OF THIS SOFTWARE.
 */

/*
 * TIFF Library.
 *
 * Strip-organized Image Support Routines.
 */
#include "tiffiop.h"

int uni_klee_patch_id;

void klee_select_patch(int *patch_id) {
  *patch_id = atoi(getenv("DAFL_PATCH_ID"));
}

void uni_klee_add_patch(int *patch_results, int patch_id, int result) {
  patch_results[patch_id] = result;
}

int uni_klee_choice(int *patch_results, int patch_id) {
  // FILE *fp=fopen(getenv("DAFL_RESULT_FILE"),"a");
  // if (fp == NULL) {
  //   fprintf(stderr, "Error opening file!\n");
  //   exit(1);
  // }
  // fprintf(fp, "%d ", patch_results[patch_id]);
  // fclose(fp);
  return patch_results[patch_id];
}

// UNI_KLEE_START
int __cpr_choice(char* lid, char* typestr,
                     long long* rvals, char** rvals_ids, int rvals_size,
                     int** lvals, char** lvals_ids, int lvals_size){
  // int patch_results[4096];
  int result;
  long long x = rvals[0];
  long long y = rvals[1];
  long long constant_a;
  int patch_results[262];
  // Patch buggy # 0
  result = (0);
  uni_klee_add_patch(patch_results, 0, result);
  // Patch 1-0 # 1
  result = (x == x);
  uni_klee_add_patch(patch_results, 1, result);
  // Patch 2-0 # 2
  constant_a = -10;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 2, result);
  // Patch 2-1 # 3
  constant_a = -9;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 3, result);
  // Patch 2-2 # 4
  constant_a = -8;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 4, result);
  // Patch 2-3 # 5
  constant_a = -7;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 5, result);
  // Patch 2-4 # 6
  constant_a = -6;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 6, result);
  // Patch 2-5 # 7
  constant_a = -5;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 7, result);
  // Patch 2-6 # 8
  constant_a = -4;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 8, result);
  // Patch 2-7 # 9
  constant_a = -3;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 9, result);
  // Patch 2-8 # 10
  constant_a = -2;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 10, result);
  // Patch 2-9 # 11
  constant_a = -1;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 11, result);
  // Patch 2-10 # 12
  constant_a = 0;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 12, result);
  // Patch 2-11 # 13
  constant_a = 1;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 13, result);
  // Patch 2-12 # 14
  constant_a = 2;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 14, result);
  // Patch 2-13 # 15
  constant_a = 3;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 15, result);
  // Patch 2-14 # 16
  constant_a = 4;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 16, result);
  // Patch 2-15 # 17
  constant_a = 5;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 17, result);
  // Patch 2-16 # 18
  constant_a = 6;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 18, result);
  // Patch 2-17 # 19
  constant_a = 7;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 19, result);
  // Patch 2-18 # 20
  constant_a = 8;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 20, result);
  // Patch 2-19 # 21
  constant_a = 9;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 21, result);
  // Patch 2-20 # 22
  constant_a = 10;
  result = (constant_a == x);
  uni_klee_add_patch(patch_results, 22, result);
  // Patch 3-0 # 23
  result = (y == x);
  uni_klee_add_patch(patch_results, 23, result);
  // Patch 4-0 # 24
  constant_a = -10;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 24, result);
  // Patch 4-1 # 25
  constant_a = -9;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 25, result);
  // Patch 4-2 # 26
  constant_a = -8;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 26, result);
  // Patch 4-3 # 27
  constant_a = -7;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 27, result);
  // Patch 4-4 # 28
  constant_a = -6;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 28, result);
  // Patch 4-5 # 29
  constant_a = -5;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 29, result);
  // Patch 4-6 # 30
  constant_a = -4;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 30, result);
  // Patch 4-7 # 31
  constant_a = -3;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 31, result);
  // Patch 4-8 # 32
  constant_a = -2;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 32, result);
  // Patch 4-9 # 33
  constant_a = -1;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 33, result);
  // Patch 4-10 # 34
  constant_a = 0;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 34, result);
  // Patch 4-11 # 35
  constant_a = 1;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 35, result);
  // Patch 4-12 # 36
  constant_a = 2;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 36, result);
  // Patch 4-13 # 37
  constant_a = 3;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 37, result);
  // Patch 4-14 # 38
  constant_a = 4;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 38, result);
  // Patch 4-15 # 39
  constant_a = 5;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 39, result);
  // Patch 4-16 # 40
  constant_a = 6;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 40, result);
  // Patch 4-17 # 41
  constant_a = 7;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 41, result);
  // Patch 4-18 # 42
  constant_a = 8;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 42, result);
  // Patch 4-19 # 43
  constant_a = 9;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 43, result);
  // Patch 4-20 # 44
  constant_a = 10;
  result = (y == constant_a);
  uni_klee_add_patch(patch_results, 44, result);
  // Patch 5-0 # 45
  result = (x != x);
  uni_klee_add_patch(patch_results, 45, result);
  // Patch 6-0 # 46
  constant_a = -10;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 46, result);
  // Patch 6-1 # 47
  constant_a = -9;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 47, result);
  // Patch 6-2 # 48
  constant_a = -8;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 48, result);
  // Patch 6-3 # 49
  constant_a = -7;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 49, result);
  // Patch 6-4 # 50
  constant_a = -6;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 50, result);
  // Patch 6-5 # 51
  constant_a = -5;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 51, result);
  // Patch 6-6 # 52
  constant_a = -4;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 52, result);
  // Patch 6-7 # 53
  constant_a = -3;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 53, result);
  // Patch 6-8 # 54
  constant_a = -2;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 54, result);
  // Patch 6-9 # 55
  constant_a = -1;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 55, result);
  // Patch 6-10 # 56
  constant_a = 0;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 56, result);
  // Patch 6-11 # 57
  constant_a = 1;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 57, result);
  // Patch 6-12 # 58
  constant_a = 2;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 58, result);
  // Patch 6-13 # 59
  constant_a = 3;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 59, result);
  // Patch 6-14 # 60
  constant_a = 4;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 60, result);
  // Patch 6-15 # 61
  constant_a = 5;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 61, result);
  // Patch 6-16 # 62
  constant_a = 6;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 62, result);
  // Patch 6-17 # 63
  constant_a = 7;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 63, result);
  // Patch 6-18 # 64
  constant_a = 8;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 64, result);
  // Patch 6-19 # 65
  constant_a = 9;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 65, result);
  // Patch 6-20 # 66
  constant_a = 10;
  result = (constant_a != x);
  uni_klee_add_patch(patch_results, 66, result);
  // Patch 7-0 # 67
  result = (y != x);
  uni_klee_add_patch(patch_results, 67, result);
  // Patch 8-0 # 68
  constant_a = -10;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 68, result);
  // Patch 8-1 # 69
  constant_a = -9;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 69, result);
  // Patch 8-2 # 70
  constant_a = -8;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 70, result);
  // Patch 8-3 # 71
  constant_a = -7;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 71, result);
  // Patch 8-4 # 72
  constant_a = -6;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 72, result);
  // Patch 8-5 # 73
  constant_a = -5;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 73, result);
  // Patch 8-6 # 74
  constant_a = -4;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 74, result);
  // Patch 8-7 # 75
  constant_a = -3;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 75, result);
  // Patch 8-8 # 76
  constant_a = -2;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 76, result);
  // Patch 8-9 # 77
  constant_a = -1;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 77, result);
  // Patch 8-10 # 78
  constant_a = 0;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 78, result);
  // Patch 8-11 # 79
  constant_a = 1;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 79, result);
  // Patch 8-12 # 80
  constant_a = 2;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 80, result);
  // Patch 8-13 # 81
  constant_a = 3;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 81, result);
  // Patch 8-14 # 82
  constant_a = 4;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 82, result);
  // Patch 8-15 # 83
  constant_a = 5;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 83, result);
  // Patch 8-16 # 84
  constant_a = 6;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 84, result);
  // Patch 8-17 # 85
  constant_a = 7;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 85, result);
  // Patch 8-18 # 86
  constant_a = 8;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 86, result);
  // Patch 8-19 # 87
  constant_a = 9;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 87, result);
  // Patch 8-20 # 88
  constant_a = 10;
  result = (y != constant_a);
  uni_klee_add_patch(patch_results, 88, result);
  // Patch 9-0 # 89
  constant_a = -10;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 89, result);
  // Patch 9-1 # 90
  constant_a = -9;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 90, result);
  // Patch 9-2 # 91
  constant_a = -8;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 91, result);
  // Patch 9-3 # 92
  constant_a = -7;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 92, result);
  // Patch 9-4 # 93
  constant_a = -6;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 93, result);
  // Patch 9-5 # 94
  constant_a = -5;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 94, result);
  // Patch 9-6 # 95
  constant_a = -4;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 95, result);
  // Patch 9-7 # 96
  constant_a = -3;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 96, result);
  // Patch 9-8 # 97
  constant_a = -2;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 97, result);
  // Patch 9-9 # 98
  constant_a = -1;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 98, result);
  // Patch 9-10 # 99
  constant_a = 0;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 99, result);
  // Patch 9-11 # 100
  constant_a = 1;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 100, result);
  // Patch 9-12 # 101
  constant_a = 2;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 101, result);
  // Patch 9-13 # 102
  constant_a = 3;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 102, result);
  // Patch 9-14 # 103
  constant_a = 4;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 103, result);
  // Patch 9-15 # 104
  constant_a = 5;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 104, result);
  // Patch 9-16 # 105
  constant_a = 6;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 105, result);
  // Patch 9-17 # 106
  constant_a = 7;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 106, result);
  // Patch 9-18 # 107
  constant_a = 8;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 107, result);
  // Patch 9-19 # 108
  constant_a = 9;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 108, result);
  // Patch 9-20 # 109
  constant_a = 10;
  result = (constant_a < x);
  uni_klee_add_patch(patch_results, 109, result);
  // Patch 10-0 # 110
  result = (y < x);
  uni_klee_add_patch(patch_results, 110, result);
  // Patch 11-0 # 111
  constant_a = -10;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 111, result);
  // Patch 11-1 # 112
  constant_a = -9;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 112, result);
  // Patch 11-2 # 113
  constant_a = -8;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 113, result);
  // Patch 11-3 # 114
  constant_a = -7;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 114, result);
  // Patch 11-4 # 115
  constant_a = -6;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 115, result);
  // Patch 11-5 # 116
  constant_a = -5;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 116, result);
  // Patch 11-6 # 117
  constant_a = -4;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 117, result);
  // Patch 11-7 # 118
  constant_a = -3;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 118, result);
  // Patch 11-8 # 119
  constant_a = -2;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 119, result);
  // Patch 11-9 # 120
  constant_a = -1;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 120, result);
  // Patch 11-10 # 121
  constant_a = 0;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 121, result);
  // Patch 11-11 # 122
  constant_a = 1;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 122, result);
  // Patch 11-12 # 123
  constant_a = 2;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 123, result);
  // Patch 11-13 # 124
  constant_a = 3;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 124, result);
  // Patch 11-14 # 125
  constant_a = 4;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 125, result);
  // Patch 11-15 # 126
  constant_a = 5;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 126, result);
  // Patch 11-16 # 127
  constant_a = 6;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 127, result);
  // Patch 11-17 # 128
  constant_a = 7;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 128, result);
  // Patch 11-18 # 129
  constant_a = 8;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 129, result);
  // Patch 11-19 # 130
  constant_a = 9;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 130, result);
  // Patch 11-20 # 131
  constant_a = 10;
  result = (x < constant_a);
  uni_klee_add_patch(patch_results, 131, result);
  // Patch 12-0 # 132
  constant_a = -10;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 132, result);
  // Patch 12-1 # 133
  constant_a = -9;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 133, result);
  // Patch 12-2 # 134
  constant_a = -8;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 134, result);
  // Patch 12-3 # 135
  constant_a = -7;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 135, result);
  // Patch 12-4 # 136
  constant_a = -6;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 136, result);
  // Patch 12-5 # 137
  constant_a = -5;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 137, result);
  // Patch 12-6 # 138
  constant_a = -4;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 138, result);
  // Patch 12-7 # 139
  constant_a = -3;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 139, result);
  // Patch 12-8 # 140
  constant_a = -2;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 140, result);
  // Patch 12-9 # 141
  constant_a = -1;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 141, result);
  // Patch 12-10 # 142
  constant_a = 0;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 142, result);
  // Patch 12-11 # 143
  constant_a = 1;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 143, result);
  // Patch 12-12 # 144
  constant_a = 2;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 144, result);
  // Patch 12-13 # 145
  constant_a = 3;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 145, result);
  // Patch 12-14 # 146
  constant_a = 4;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 146, result);
  // Patch 12-15 # 147
  constant_a = 5;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 147, result);
  // Patch 12-16 # 148
  constant_a = 6;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 148, result);
  // Patch 12-17 # 149
  constant_a = 7;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 149, result);
  // Patch 12-18 # 150
  constant_a = 8;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 150, result);
  // Patch 12-19 # 151
  constant_a = 9;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 151, result);
  // Patch 12-20 # 152
  constant_a = 10;
  result = (y < constant_a);
  uni_klee_add_patch(patch_results, 152, result);
  // Patch 13-0 # 153
  result = (x < y);
  uni_klee_add_patch(patch_results, 153, result);
  // Patch 14-0 # 154
  constant_a = -10;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 154, result);
  // Patch 14-1 # 155
  constant_a = -9;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 155, result);
  // Patch 14-2 # 156
  constant_a = -8;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 156, result);
  // Patch 14-3 # 157
  constant_a = -7;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 157, result);
  // Patch 14-4 # 158
  constant_a = -6;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 158, result);
  // Patch 14-5 # 159
  constant_a = -5;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 159, result);
  // Patch 14-6 # 160
  constant_a = -4;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 160, result);
  // Patch 14-7 # 161
  constant_a = -3;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 161, result);
  // Patch 14-8 # 162
  constant_a = -2;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 162, result);
  // Patch 14-9 # 163
  constant_a = -1;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 163, result);
  // Patch 14-10 # 164
  constant_a = 0;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 164, result);
  // Patch 14-11 # 165
  constant_a = 1;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 165, result);
  // Patch 14-12 # 166
  constant_a = 2;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 166, result);
  // Patch 14-13 # 167
  constant_a = 3;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 167, result);
  // Patch 14-14 # 168
  constant_a = 4;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 168, result);
  // Patch 14-15 # 169
  constant_a = 5;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 169, result);
  // Patch 14-16 # 170
  constant_a = 6;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 170, result);
  // Patch 14-17 # 171
  constant_a = 7;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 171, result);
  // Patch 14-18 # 172
  constant_a = 8;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 172, result);
  // Patch 14-19 # 173
  constant_a = 9;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 173, result);
  // Patch 14-20 # 174
  constant_a = 10;
  result = (constant_a < y);
  uni_klee_add_patch(patch_results, 174, result);
  // Patch 15-0 # 175
  constant_a = -10;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 175, result);
  // Patch 15-1 # 176
  constant_a = -9;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 176, result);
  // Patch 15-2 # 177
  constant_a = -8;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 177, result);
  // Patch 15-3 # 178
  constant_a = -7;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 178, result);
  // Patch 15-4 # 179
  constant_a = -6;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 179, result);
  // Patch 15-5 # 180
  constant_a = -5;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 180, result);
  // Patch 15-6 # 181
  constant_a = -4;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 181, result);
  // Patch 15-7 # 182
  constant_a = -3;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 182, result);
  // Patch 15-8 # 183
  constant_a = -2;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 183, result);
  // Patch 15-9 # 184
  constant_a = -1;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 184, result);
  // Patch 15-10 # 185
  constant_a = 0;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 185, result);
  // Patch 15-11 # 186
  constant_a = 1;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 186, result);
  // Patch 15-12 # 187
  constant_a = 2;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 187, result);
  // Patch 15-13 # 188
  constant_a = 3;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 188, result);
  // Patch 15-14 # 189
  constant_a = 4;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 189, result);
  // Patch 15-15 # 190
  constant_a = 5;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 190, result);
  // Patch 15-16 # 191
  constant_a = 6;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 191, result);
  // Patch 15-17 # 192
  constant_a = 7;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 192, result);
  // Patch 15-18 # 193
  constant_a = 8;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 193, result);
  // Patch 15-19 # 194
  constant_a = 9;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 194, result);
  // Patch 15-20 # 195
  constant_a = 10;
  result = (constant_a <= x);
  uni_klee_add_patch(patch_results, 195, result);
  // Patch 16-0 # 196
  result = (y <= x);
  uni_klee_add_patch(patch_results, 196, result);
  // Patch 17-0 # 197
  constant_a = -10;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 197, result);
  // Patch 17-1 # 198
  constant_a = -9;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 198, result);
  // Patch 17-2 # 199
  constant_a = -8;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 199, result);
  // Patch 17-3 # 200
  constant_a = -7;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 200, result);
  // Patch 17-4 # 201
  constant_a = -6;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 201, result);
  // Patch 17-5 # 202
  constant_a = -5;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 202, result);
  // Patch 17-6 # 203
  constant_a = -4;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 203, result);
  // Patch 17-7 # 204
  constant_a = -3;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 204, result);
  // Patch 17-8 # 205
  constant_a = -2;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 205, result);
  // Patch 17-9 # 206
  constant_a = -1;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 206, result);
  // Patch 17-10 # 207
  constant_a = 0;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 207, result);
  // Patch 17-11 # 208
  constant_a = 1;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 208, result);
  // Patch 17-12 # 209
  constant_a = 2;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 209, result);
  // Patch 17-13 # 210
  constant_a = 3;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 210, result);
  // Patch 17-14 # 211
  constant_a = 4;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 211, result);
  // Patch 17-15 # 212
  constant_a = 5;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 212, result);
  // Patch 17-16 # 213
  constant_a = 6;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 213, result);
  // Patch 17-17 # 214
  constant_a = 7;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 214, result);
  // Patch 17-18 # 215
  constant_a = 8;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 215, result);
  // Patch 17-19 # 216
  constant_a = 9;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 216, result);
  // Patch 17-20 # 217
  constant_a = 10;
  result = (x <= constant_a);
  uni_klee_add_patch(patch_results, 217, result);
  // Patch 18-0 # 218
  constant_a = -10;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 218, result);
  // Patch 18-1 # 219
  constant_a = -9;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 219, result);
  // Patch 18-2 # 220
  constant_a = -8;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 220, result);
  // Patch 18-3 # 221
  constant_a = -7;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 221, result);
  // Patch 18-4 # 222
  constant_a = -6;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 222, result);
  // Patch 18-5 # 223
  constant_a = -5;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 223, result);
  // Patch 18-6 # 224
  constant_a = -4;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 224, result);
  // Patch 18-7 # 225
  constant_a = -3;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 225, result);
  // Patch 18-8 # 226
  constant_a = -2;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 226, result);
  // Patch 18-9 # 227
  constant_a = -1;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 227, result);
  // Patch 18-10 # 228
  constant_a = 0;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 228, result);
  // Patch 18-11 # 229
  constant_a = 1;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 229, result);
  // Patch 18-12 # 230
  constant_a = 2;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 230, result);
  // Patch 18-13 # 231
  constant_a = 3;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 231, result);
  // Patch 18-14 # 232
  constant_a = 4;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 232, result);
  // Patch 18-15 # 233
  constant_a = 5;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 233, result);
  // Patch 18-16 # 234
  constant_a = 6;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 234, result);
  // Patch 18-17 # 235
  constant_a = 7;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 235, result);
  // Patch 18-18 # 236
  constant_a = 8;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 236, result);
  // Patch 18-19 # 237
  constant_a = 9;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 237, result);
  // Patch 18-20 # 238
  constant_a = 10;
  result = (y <= constant_a);
  uni_klee_add_patch(patch_results, 238, result);
  // Patch 19-0 # 239
  result = (x <= y);
  uni_klee_add_patch(patch_results, 239, result);
  // Patch 20-0 # 240
  constant_a = -10;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 240, result);
  // Patch 20-1 # 241
  constant_a = -9;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 241, result);
  // Patch 20-2 # 242
  constant_a = -8;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 242, result);
  // Patch 20-3 # 243
  constant_a = -7;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 243, result);
  // Patch 20-4 # 244
  constant_a = -6;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 244, result);
  // Patch 20-5 # 245
  constant_a = -5;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 245, result);
  // Patch 20-6 # 246
  constant_a = -4;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 246, result);
  // Patch 20-7 # 247
  constant_a = -3;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 247, result);
  // Patch 20-8 # 248
  constant_a = -2;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 248, result);
  // Patch 20-9 # 249
  constant_a = -1;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 249, result);
  // Patch 20-10 # 250
  constant_a = 0;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 250, result);
  // Patch 20-11 # 251
  constant_a = 1;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 251, result);
  // Patch 20-12 # 252
  constant_a = 2;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 252, result);
  // Patch 20-13 # 253
  constant_a = 3;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 253, result);
  // Patch 20-14 # 254
  constant_a = 4;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 254, result);
  // Patch 20-15 # 255
  constant_a = 5;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 255, result);
  // Patch 20-16 # 256
  constant_a = 6;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 256, result);
  // Patch 20-17 # 257
  constant_a = 7;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 257, result);
  // Patch 20-18 # 258
  constant_a = 8;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 258, result);
  // Patch 20-19 # 259
  constant_a = 9;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 259, result);
  // Patch 20-20 # 260
  constant_a = 10;
  result = (constant_a <= y);
  uni_klee_add_patch(patch_results, 260, result);
  // Patch correct # 261
  result = (x != 0);
  uni_klee_add_patch(patch_results, 261, result);
  klee_select_patch(&uni_klee_patch_id);
  return uni_klee_choice(patch_results, uni_klee_patch_id);
}
// UNI_KLEE_END


/*
 * Compute which strip a (row,sample) value is in.
 */
uint32
TIFFComputeStrip(TIFF* tif, uint32 row, uint16 sample)
{
	static const char module[] = "TIFFComputeStrip";
	TIFFDirectory *td = &tif->tif_dir;
	uint32 strip;

	strip = row / td->td_rowsperstrip;
	if (td->td_planarconfig == PLANARCONFIG_SEPARATE) {
		if (sample >= td->td_samplesperpixel) {
			TIFFErrorExt(tif->tif_clientdata, module,
			    "%lu: Sample out of range, max %lu",
			    (unsigned long) sample, (unsigned long) td->td_samplesperpixel);
			return (0);
		}
		strip += (uint32)sample*td->td_stripsperimage;
	}
	return (strip);
}

/*
 * Compute how many strips are in an image.
 */
uint32
TIFFNumberOfStrips(TIFF* tif)
{
	TIFFDirectory *td = &tif->tif_dir;
	uint32 nstrips;
	if (__cpr_choice("L65", "bool", (long long[]){td->td_nstrips, td->td_rowsperstrip}, (char *[]){"x", "y"}, 2, (int *[]){}, (char *[]){}, 0))	return td->td_nstrips;

	assert(td->td_nstrips == NULL);

	nstrips = (td->td_rowsperstrip == (uint32) -1 ? 1 :
	     TIFFhowmany_32(td->td_imagelength, td->td_rowsperstrip));
	if (td->td_planarconfig == PLANARCONFIG_SEPARATE)
		nstrips = _TIFFMultiply32(tif, nstrips, (uint32)td->td_samplesperpixel,
		    "TIFFNumberOfStrips");
	return (nstrips);
}

/*
 * Compute the # bytes in a variable height, row-aligned strip.
 */
uint64
TIFFVStripSize64(TIFF* tif, uint32 nrows)
{
	static const char module[] = "TIFFVStripSize64";
	TIFFDirectory *td = &tif->tif_dir;
	if (nrows==(uint32)(-1))
		nrows=td->td_imagelength;
	if ((td->td_planarconfig==PLANARCONFIG_CONTIG)&&
	    (td->td_photometric == PHOTOMETRIC_YCBCR)&&
	    (!isUpSampled(tif)))
	{
		/*
		 * Packed YCbCr data contain one Cb+Cr for every
		 * HorizontalSampling*VerticalSampling Y values.
		 * Must also roundup width and height when calculating
		 * since images that are not a multiple of the
		 * horizontal/vertical subsampling area include
		 * YCbCr data for the extended image.
		 */
		uint16 ycbcrsubsampling[2];
		uint16 samplingblock_samples;
		uint32 samplingblocks_hor;
		uint32 samplingblocks_ver;
		uint64 samplingrow_samples;
		uint64 samplingrow_size;
		if(td->td_samplesperpixel!=3)
		{
			TIFFErrorExt(tif->tif_clientdata,module,
			    "Invalid td_samplesperpixel value");
			return 0;
		}
		TIFFGetFieldDefaulted(tif,TIFFTAG_YCBCRSUBSAMPLING,ycbcrsubsampling+0,
		    ycbcrsubsampling+1);
		if ((ycbcrsubsampling[0] != 1 && ycbcrsubsampling[0] != 2 && ycbcrsubsampling[0] != 4)
		    ||(ycbcrsubsampling[1] != 1 && ycbcrsubsampling[1] != 2 && ycbcrsubsampling[1] != 4))
		{
			TIFFErrorExt(tif->tif_clientdata,module,
				     "Invalid YCbCr subsampling (%dx%d)", 
				     ycbcrsubsampling[0], 
				     ycbcrsubsampling[1] );
			return 0;
		}
		samplingblock_samples=ycbcrsubsampling[0]*ycbcrsubsampling[1]+2;
		samplingblocks_hor=TIFFhowmany_32(td->td_imagewidth,ycbcrsubsampling[0]);
		samplingblocks_ver=TIFFhowmany_32(nrows,ycbcrsubsampling[1]);
		samplingrow_samples=_TIFFMultiply64(tif,samplingblocks_hor,samplingblock_samples,module);
		samplingrow_size=TIFFhowmany8_64(_TIFFMultiply64(tif,samplingrow_samples,td->td_bitspersample,module));
		return(_TIFFMultiply64(tif,samplingrow_size,samplingblocks_ver,module));
	}
	else
		return(_TIFFMultiply64(tif,nrows,TIFFScanlineSize64(tif),module));
}
tmsize_t
TIFFVStripSize(TIFF* tif, uint32 nrows)
{
	static const char module[] = "TIFFVStripSize";
	uint64 m;
	tmsize_t n;
	m=TIFFVStripSize64(tif,nrows);
	n=(tmsize_t)m;
	if ((uint64)n!=m)
	{
		TIFFErrorExt(tif->tif_clientdata,module,"Integer overflow");
		n=0;
	}
	return(n);
}

/*
 * Compute the # bytes in a raw strip.
 */
uint64
TIFFRawStripSize64(TIFF* tif, uint32 strip)
{
	static const char module[] = "TIFFRawStripSize64";
	TIFFDirectory* td = &tif->tif_dir;
	uint64 bytecount = td->td_stripbytecount[strip];

	if (bytecount == 0)
	{
#if defined(__WIN32__) && (defined(_MSC_VER) || defined(__MINGW32__))
		TIFFErrorExt(tif->tif_clientdata, module,
			     "%I64u: Invalid strip byte count, strip %lu",
			     (unsigned __int64) bytecount,
			     (unsigned long) strip);
#else
		TIFFErrorExt(tif->tif_clientdata, module,
			     "%llu: Invalid strip byte count, strip %lu",
			     (unsigned long long) bytecount,
			     (unsigned long) strip);
#endif
		bytecount = (uint64) -1;
	}

	return bytecount;
}
tmsize_t
TIFFRawStripSize(TIFF* tif, uint32 strip)
{
	static const char module[] = "TIFFRawStripSize";
	uint64 m;
	tmsize_t n;
	m=TIFFRawStripSize64(tif,strip);
	if (m==(uint64)(-1))
		n=(tmsize_t)(-1);
	else
	{
		n=(tmsize_t)m;
		if ((uint64)n!=m)
		{
			TIFFErrorExt(tif->tif_clientdata,module,"Integer overflow");
			n=0;
		}
	}
	return(n);
}

/*
 * Compute the # bytes in a (row-aligned) strip.
 *
 * Note that if RowsPerStrip is larger than the
 * recorded ImageLength, then the strip size is
 * truncated to reflect the actual space required
 * to hold the strip.
 */
uint64
TIFFStripSize64(TIFF* tif)
{
	TIFFDirectory* td = &tif->tif_dir;
	uint32 rps = td->td_rowsperstrip;
	if (rps > td->td_imagelength)
		rps = td->td_imagelength;
	return (TIFFVStripSize64(tif, rps));
}
tmsize_t
TIFFStripSize(TIFF* tif)
{
	static const char module[] = "TIFFStripSize";
	uint64 m;
	tmsize_t n;
	m=TIFFStripSize64(tif);
	n=(tmsize_t)m;
	if ((uint64)n!=m)
	{
		TIFFErrorExt(tif->tif_clientdata,module,"Integer overflow");
		n=0;
	}
	return(n);
}

/*
 * Compute a default strip size based on the image
 * characteristics and a requested value.  If the
 * request is <1 then we choose a strip size according
 * to certain heuristics.
 */
uint32
TIFFDefaultStripSize(TIFF* tif, uint32 request)
{
	return (*tif->tif_defstripsize)(tif, request);
}

uint32
_TIFFDefaultStripSize(TIFF* tif, uint32 s)
{
	if ((int32) s < 1) {
		/*
		 * If RowsPerStrip is unspecified, try to break the
		 * image up into strips that are approximately
		 * STRIP_SIZE_DEFAULT bytes long.
		 */
		uint64 scanlinesize;
		uint64 rows;
		scanlinesize=TIFFScanlineSize64(tif);
		if (scanlinesize==0)
			scanlinesize=1;
		rows=(uint64)STRIP_SIZE_DEFAULT/scanlinesize;
		if (rows==0)
			rows=1;
		else if (rows>0xFFFFFFFF)
			rows=0xFFFFFFFF;
		s=(uint32)rows;
	}
	return (s);
}

/*
 * Return the number of bytes to read/write in a call to
 * one of the scanline-oriented i/o routines.  Note that
 * this number may be 1/samples-per-pixel if data is
 * stored as separate planes.
 * The ScanlineSize in case of YCbCrSubsampling is defined as the
 * strip size divided by the strip height, i.e. the size of a pack of vertical
 * subsampling lines divided by vertical subsampling. It should thus make
 * sense when multiplied by a multiple of vertical subsampling.
 */
uint64
TIFFScanlineSize64(TIFF* tif)
{
	static const char module[] = "TIFFScanlineSize64";
	TIFFDirectory *td = &tif->tif_dir;
	uint64 scanline_size;
	if (td->td_planarconfig==PLANARCONFIG_CONTIG)
	{
		if ((td->td_photometric==PHOTOMETRIC_YCBCR)&&
		    (td->td_samplesperpixel==3)&&
		    (!isUpSampled(tif)))
		{
			uint16 ycbcrsubsampling[2];
			uint16 samplingblock_samples;
			uint32 samplingblocks_hor;
			uint64 samplingrow_samples;
			uint64 samplingrow_size;
			if(td->td_samplesperpixel!=3)
			{
                            TIFFErrorExt(tif->tif_clientdata,module,
                                         "Invalid td_samplesperpixel value");
                            return 0;
			}
			TIFFGetFieldDefaulted(tif,TIFFTAG_YCBCRSUBSAMPLING,
                                              ycbcrsubsampling+0,
                                              ycbcrsubsampling+1);
			if (((ycbcrsubsampling[0]!=1)&&(ycbcrsubsampling[0]!=2)&&(ycbcrsubsampling[0]!=4)) ||
			    ((ycbcrsubsampling[1]!=1)&&(ycbcrsubsampling[1]!=2)&&(ycbcrsubsampling[1]!=4)))
			{
                            TIFFErrorExt(tif->tif_clientdata,module,
                                         "Invalid YCbCr subsampling");
                            return 0;
			}
			samplingblock_samples = ycbcrsubsampling[0]*ycbcrsubsampling[1]+2;
			samplingblocks_hor = TIFFhowmany_32(td->td_imagewidth,ycbcrsubsampling[0]);
			samplingrow_samples = _TIFFMultiply64(tif,samplingblocks_hor,samplingblock_samples,module);
			samplingrow_size = TIFFhowmany_64(_TIFFMultiply64(tif,samplingrow_samples,td->td_bitspersample,module),8);
			scanline_size = (samplingrow_size/ycbcrsubsampling[1]);
		}
		else
		{
			uint64 scanline_samples;
			scanline_samples=_TIFFMultiply64(tif,td->td_imagewidth,td->td_samplesperpixel,module);
			scanline_size=TIFFhowmany_64(_TIFFMultiply64(tif,scanline_samples,td->td_bitspersample,module),8);
		}
	}
	else
        {
		scanline_size=TIFFhowmany_64(_TIFFMultiply64(tif,td->td_imagewidth,td->td_bitspersample,module),8);
        }
        if (scanline_size == 0)
        {
                TIFFErrorExt(tif->tif_clientdata,module,"Computed scanline size is zero");
                return 0;
        }
	return(scanline_size);
}
tmsize_t
TIFFScanlineSize(TIFF* tif)
{
	static const char module[] = "TIFFScanlineSize";
	uint64 m;
	tmsize_t n;
	m=TIFFScanlineSize64(tif);
	n=(tmsize_t)m;
	if ((uint64)n!=m) {
		TIFFErrorExt(tif->tif_clientdata,module,"Integer arithmetic overflow");
		n=0;
	}
	return(n);
}

/*
 * Return the number of bytes required to store a complete
 * decoded and packed raster scanline (as opposed to the
 * I/O size returned by TIFFScanlineSize which may be less
 * if data is store as separate planes).
 */
uint64
TIFFRasterScanlineSize64(TIFF* tif)
{
	static const char module[] = "TIFFRasterScanlineSize64";
	TIFFDirectory *td = &tif->tif_dir;
	uint64 scanline;

	scanline = _TIFFMultiply64(tif, td->td_bitspersample, td->td_imagewidth, module);
	if (td->td_planarconfig == PLANARCONFIG_CONTIG) {
		scanline = _TIFFMultiply64(tif, scanline, td->td_samplesperpixel, module);
		return (TIFFhowmany8_64(scanline));
	} else
		return (_TIFFMultiply64(tif, TIFFhowmany8_64(scanline),
		    td->td_samplesperpixel, module));
}
tmsize_t
TIFFRasterScanlineSize(TIFF* tif)
{
	static const char module[] = "TIFFRasterScanlineSize";
	uint64 m;
	tmsize_t n;
	m=TIFFRasterScanlineSize64(tif);
	n=(tmsize_t)m;
	if ((uint64)n!=m)
	{
		TIFFErrorExt(tif->tif_clientdata,module,"Integer arithmetic overflow");
		n=0;
	}
	return(n);
}

/* vim: set ts=8 sts=8 sw=8 noet: */
/*
 * Local Variables:
 * mode: c
 * c-basic-offset: 8
 * fill-column: 78
 * End:
 */
